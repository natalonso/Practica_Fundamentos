<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Ajuste, interpretación y diagnosis del modelo de regresión lineal múltiple | Practica Fundamentos Casas</title>
  <meta name="description" content="8 Ajuste, interpretación y diagnosis del modelo de regresión lineal múltiple | Practica Fundamentos Casas" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Ajuste, interpretación y diagnosis del modelo de regresión lineal múltiple | Practica Fundamentos Casas" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Ajuste, interpretación y diagnosis del modelo de regresión lineal múltiple | Practica Fundamentos Casas" />
  
  
  

<meta name="author" content="Natalia Alonso, Beatriz Martín y Susana Albarran" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="selección-de-variable.html"/>
<link rel="next" href="test.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.10/datatables.js"></script>
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="objetivo-del-estudio.html"><a href="objetivo-del-estudio.html"><i class="fa fa-check"></i><b>2</b> Objetivo del estudio</a></li>
<li class="chapter" data-level="3" data-path="descripción-de-los-datos.html"><a href="descripción-de-los-datos.html"><i class="fa fa-check"></i><b>3</b> Descripción de los datos</a></li>
<li class="chapter" data-level="4" data-path="train-test-y-validación.html"><a href="train-test-y-validación.html"><i class="fa fa-check"></i><b>4</b> Train, test y validación</a></li>
<li class="chapter" data-level="5" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html"><i class="fa fa-check"></i><b>5</b> Análisis exploratorio de datos</a><ul>
<li class="chapter" data-level="5.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#características-de-las-casas"><i class="fa fa-check"></i><b>5.1</b> Características de las casas</a></li>
<li class="chapter" data-level="5.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#calidad"><i class="fa fa-check"></i><b>5.2</b> Calidad</a></li>
<li class="chapter" data-level="5.3" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#localización"><i class="fa fa-check"></i><b>5.3</b> Localización</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="detección-tratamiento-e-imputación-de-datos-faltantes.html"><a href="detección-tratamiento-e-imputación-de-datos-faltantes.html"><i class="fa fa-check"></i><b>6</b> Detección, tratamiento e imputación de datos faltantes</a></li>
<li class="chapter" data-level="7" data-path="selección-de-variable.html"><a href="selección-de-variable.html"><i class="fa fa-check"></i><b>7</b> Selección de variable</a></li>
<li class="chapter" data-level="8" data-path="ajuste-interpretación-y-diagnosis-del-modelo-de-regresión-lineal-múltiple.html"><a href="ajuste-interpretación-y-diagnosis-del-modelo-de-regresión-lineal-múltiple.html"><i class="fa fa-check"></i><b>8</b> Ajuste, interpretación y diagnosis del modelo de regresión lineal múltiple</a></li>
<li class="chapter" data-level="9" data-path="test.html"><a href="test.html"><i class="fa fa-check"></i><b>9</b> Test</a><ul>
<li class="chapter" data-level="9.1" data-path="test.html"><a href="test.html#variable-respuesta-test-vs-valor-predicho"><i class="fa fa-check"></i><b>9.1</b> Variable respuesta test vs valor predicho</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practica Fundamentos Casas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ajuste-interpretación-y-diagnosis-del-modelo-de-regresión-lineal-múltiple" class="section level1">
<h1><span class="header-section-number">8</span> Ajuste, interpretación y diagnosis del modelo de regresión lineal múltiple</h1>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">datos_train_model &lt;-<span class="st"> </span>datos_train[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">22</span>,<span class="dv">4</span>,<span class="dv">23</span>,<span class="dv">7</span>,<span class="dv">24</span>,<span class="dv">8</span><span class="op">:</span><span class="dv">11</span>,<span class="dv">26</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">18</span><span class="op">:</span><span class="dv">21</span>,<span class="dv">25</span>,<span class="dv">27</span>)]</a>
<a class="sourceLine" id="cb85-2" title="2"></a>
<a class="sourceLine" id="cb85-3" title="3">datos_train_model<span class="op">$</span>waterfront&lt;-<span class="kw">as.factor</span>(datos_train_model<span class="op">$</span>waterfront)</a>
<a class="sourceLine" id="cb85-4" title="4">datos_train_model<span class="op">$</span>view&lt;-<span class="kw">as.factor</span>(datos_train_model<span class="op">$</span>view)</a>
<a class="sourceLine" id="cb85-5" title="5">datos_train_model<span class="op">$</span>condition&lt;-<span class="kw">as.factor</span>(datos_train_model<span class="op">$</span>condition)</a>
<a class="sourceLine" id="cb85-6" title="6"></a>
<a class="sourceLine" id="cb85-7" title="7">datos_train_model<span class="op">$</span>bathrooms_group&lt;-<span class="kw">as.numeric</span>(datos_train_model<span class="op">$</span>bathrooms_group)</a></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co">#Ahora reescalamos un variable de la base de datos</span></a>
<a class="sourceLine" id="cb86-2" title="2"></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="co">#Sin reescalar para comprobar los efectos de los 3 tipos de reescalados:</span></a>
<a class="sourceLine" id="cb86-4" title="4"><span class="kw">ggplot</span>(datos_train_model, <span class="kw">aes</span>(<span class="dt">x=</span>log_price)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">fill=</span><span class="st">&quot;#E1AF00&quot;</span>)</a></code></pre></div>
<p><img src="PrácticaFundamentos_Casas_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co">#FORMA1: F-score scaling: resta la media y divide por la desviación tipica</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">ggplot</span>(datos_train_model, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">scale</span>(datos_train_model<span class="op">$</span>log_price, <span class="dt">center =</span> <span class="ot">TRUE</span>, <span class="dt">scale =</span> <span class="ot">TRUE</span>) )) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">fill=</span><span class="st">&quot;#E1AF00&quot;</span>)</a></code></pre></div>
<p><img src="PrácticaFundamentos_Casas_files/figure-html/unnamed-chunk-54-2.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co">#FORMA2: 0-1 scaling: (V - min V)/(max V - min V)</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">ggplot</span>(datos_train_model, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">rescale</span>(datos_train_model<span class="op">$</span>log_price))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">fill=</span><span class="st">&quot;#E1AF00&quot;</span>)</a></code></pre></div>
<p><img src="PrácticaFundamentos_Casas_files/figure-html/unnamed-chunk-54-3.png" width="672" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co">#FORMA3: Scaling to unit length based on the euclidean length</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">ggplot</span>(datos_train_model, <span class="kw">aes</span>(<span class="dt">x=</span>datos_train_model<span class="op">$</span>log_price<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(datos_train_model<span class="op">$</span>bedrooms<span class="op">^</span><span class="dv">2</span>)))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">fill=</span><span class="st">&quot;#E1AF00&quot;</span>)</a></code></pre></div>
<p><img src="PrácticaFundamentos_Casas_files/figure-html/unnamed-chunk-54-4.png" width="672" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co">#Una vez decidamos el reescalado, reescalar todo, en caso de elegir la forma2:</span></a>
<a class="sourceLine" id="cb90-2" title="2">datos_train_model<span class="op">$</span>bedrooms&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>bedrooms)</a>
<a class="sourceLine" id="cb90-3" title="3">datos_train_model<span class="op">$</span>log_price&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>log_price)</a>
<a class="sourceLine" id="cb90-4" title="4">datos_train_model<span class="op">$</span>bathrooms_group&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>bathrooms_group)</a>
<a class="sourceLine" id="cb90-5" title="5">datos_train_model<span class="op">$</span>log_sqft_living&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>log_sqft_living)</a>
<a class="sourceLine" id="cb90-6" title="6">datos_train_model<span class="op">$</span>floors&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>floors)</a>
<a class="sourceLine" id="cb90-7" title="7">datos_train_model<span class="op">$</span>sqft_above&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>sqft_above)</a>
<a class="sourceLine" id="cb90-8" title="8">datos_train_model<span class="op">$</span>sqft_basement&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>sqft_basement)</a>
<a class="sourceLine" id="cb90-9" title="9">datos_train_model<span class="op">$</span>lat&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>lat)</a>
<a class="sourceLine" id="cb90-10" title="10">datos_train_model<span class="op">$</span>long&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>long)</a>
<a class="sourceLine" id="cb90-11" title="11">datos_train_model<span class="op">$</span>sqft_living15&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>sqft_living15)</a>
<a class="sourceLine" id="cb90-12" title="12">datos_train_model<span class="op">$</span>sqft_lot15&lt;-<span class="kw">rescale</span>(datos_train_model<span class="op">$</span>sqft_lot15)</a></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co"># Vamos a crear un data_frame nuevo limpio: (????)</span></a>
<a class="sourceLine" id="cb91-2" title="2"></a>
<a class="sourceLine" id="cb91-3" title="3">modelo6&lt;-<span class="kw">lm</span>(<span class="dt">formula =</span> log_price <span class="op">~</span><span class="st"> </span>log_sqft_living, <span class="dt">data =</span> datos_train_model)</a>
<a class="sourceLine" id="cb91-4" title="4"><span class="kw">summary</span>(modelo6)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_price ~ log_sqft_living, data = datos_train_model)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.238485 -0.063132  0.002957  0.055096  0.282330 
## 
## Coefficients:
##                 Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)     0.051733   0.003079    16.8 &lt;0.0000000000000002 ***
## log_sqft_living 0.700063   0.006139   114.0 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.08365 on 15127 degrees of freedom
## Multiple R-squared:  0.4623, Adjusted R-squared:  0.4622 
## F-statistic: 1.3e+04 on 1 and 15127 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co"># R_squared = 0.46</span></a>
<a class="sourceLine" id="cb93-2" title="2"></a>
<a class="sourceLine" id="cb93-3" title="3">modelo5&lt;-<span class="kw">lm</span>(<span class="dt">formula =</span> log_price <span class="op">~</span><span class="st"> </span>log_sqft_living <span class="op">+</span><span class="st"> </span>bathrooms_group, <span class="dt">data =</span> datos_train_model)</a>
<a class="sourceLine" id="cb93-4" title="4"><span class="kw">summary</span>(modelo5)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_price ~ log_sqft_living + bathrooms_group, data = datos_train_model)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.234945 -0.062933  0.002826  0.055338  0.281961 
## 
## Coefficients:
##                 Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)     0.056307   0.003156   17.84 &lt; 0.0000000000000002 ***
## log_sqft_living 0.655137   0.009296   70.48 &lt; 0.0000000000000002 ***
## bathrooms_group 0.057169   0.008892    6.43       0.000000000132 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.08354 on 15126 degrees of freedom
## Multiple R-squared:  0.4637, Adjusted R-squared:  0.4637 
## F-statistic:  6540 on 2 and 15126 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co"># R_squared = 0.46</span></a>
<a class="sourceLine" id="cb95-2" title="2"></a>
<a class="sourceLine" id="cb95-3" title="3">modelo4&lt;-<span class="kw">lm</span>(<span class="dt">formula =</span> log_price <span class="op">~</span><span class="st"> </span>log_sqft_living <span class="op">+</span><span class="st"> </span>bathrooms_group <span class="op">+</span><span class="st"> </span>grade_categ, <span class="dt">data =</span> datos_train_model)</a>
<a class="sourceLine" id="cb95-4" title="4"><span class="kw">summary</span>(modelo4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_price ~ log_sqft_living + bathrooms_group + 
##     grade_categ, data = datos_train_model)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.247691 -0.061087  0.002396  0.055183  0.304191 
## 
## Coefficients:
##                 Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)     0.091264   0.015865   5.753        0.00000000896 ***
## log_sqft_living 0.566862   0.009408  60.252 &lt; 0.0000000000000002 ***
## bathrooms_group 0.041202   0.008600   4.791        0.00000167817 ***
## grade_categ1    0.006131   0.015957   0.384                0.701    
## grade_categ2    0.099402   0.016324   6.089        0.00000000116 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.08065 on 15124 degrees of freedom
## Multiple R-squared:  0.5003, Adjusted R-squared:  0.5001 
## F-statistic:  3785 on 4 and 15124 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co"># R_squared = 0.5</span></a>
<a class="sourceLine" id="cb97-2" title="2"></a>
<a class="sourceLine" id="cb97-3" title="3">modelo3&lt;-<span class="kw">lm</span>(<span class="dt">formula =</span> log_price <span class="op">~</span><span class="st"> </span>log_sqft_living <span class="op">+</span><span class="st"> </span>bathrooms_group <span class="op">+</span><span class="st"> </span>grade_categ <span class="op">+</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>floors <span class="op">+</span><span class="st"> </span>yr_renovated_catg, <span class="dt">data =</span> datos_train_model)</a>
<a class="sourceLine" id="cb97-4" title="4"><span class="kw">summary</span>(modelo3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_price ~ log_sqft_living + bathrooms_group + 
##     grade_categ + lat + floors + yr_renovated_catg, data = datos_train_model)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.264926 -0.042589 -0.002836  0.038571  0.265149 
## 
## Coefficients:
##                     Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)        -0.021345   0.012832  -1.663               0.0962 .  
## log_sqft_living     0.548488   0.007596  72.207 &lt; 0.0000000000000002 ***
## bathrooms_group     0.035438   0.007587   4.671    0.000003027244360 ***
## grade_categ1       -0.012398   0.012839  -0.966               0.3342    
## grade_categ2        0.069282   0.013139   5.273    0.000000135992142 ***
## lat                 0.210309   0.002387  88.115 &lt; 0.0000000000000002 ***
## floors              0.020603   0.002881   7.152    0.000000000000894 ***
## yr_renovated_catg1  0.042241   0.002603  16.225 &lt; 0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06488 on 15121 degrees of freedom
## Multiple R-squared:  0.6767, Adjusted R-squared:  0.6765 
## F-statistic:  4521 on 7 and 15121 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co"># R_squared = 0.67</span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="co"># </span></a>
<a class="sourceLine" id="cb99-3" title="3"><span class="co"># modelo3&lt;-lm(formula = log_price ~ log_sqft_living + bathrooms_group + grade_categ + lat + yr_built, data = datos_train_model)</span></a>
<a class="sourceLine" id="cb99-4" title="4"><span class="co"># summary(modelo3)</span></a>
<a class="sourceLine" id="cb99-5" title="5"><span class="co"># R_squared = 0.68</span></a>
<a class="sourceLine" id="cb99-6" title="6"></a>
<a class="sourceLine" id="cb99-7" title="7">modelo3&lt;-<span class="kw">lm</span>(<span class="dt">formula =</span> log_price <span class="op">~</span><span class="st"> </span>log_sqft_living <span class="op">+</span><span class="st"> </span>bathrooms_group <span class="op">+</span><span class="st"> </span>grade_categ <span class="op">+</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>waterfront, <span class="dt">data =</span> datos_train_model)</a>
<a class="sourceLine" id="cb99-8" title="8"><span class="kw">summary</span>(modelo3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_price ~ log_sqft_living + bathrooms_group + 
##     grade_categ + lat + waterfront, data = datos_train_model)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.267500 -0.042102 -0.002454  0.038977  0.251554 
## 
## Coefficients:
##                  Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)     -0.023354   0.012700  -1.839               0.0659 .  
## log_sqft_living  0.545590   0.007498  72.761 &lt; 0.0000000000000002 ***
## bathrooms_group  0.056467   0.006852   8.241 &lt; 0.0000000000000002 ***
## grade_categ1    -0.012349   0.012710  -0.972               0.3313    
## grade_categ2     0.064928   0.013006   4.992          0.000000603 ***
## lat              0.213484   0.002359  90.488 &lt; 0.0000000000000002 ***
## waterfront1      0.152273   0.006101  24.959 &lt; 0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06423 on 15122 degrees of freedom
## Multiple R-squared:  0.6831, Adjusted R-squared:  0.6829 
## F-statistic:  5432 on 6 and 15122 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="co"># R_squared = 0.68</span></a>
<a class="sourceLine" id="cb101-2" title="2"></a>
<a class="sourceLine" id="cb101-3" title="3">modelo3&lt;-<span class="kw">lm</span>(<span class="dt">formula =</span> log_price <span class="op">~</span><span class="st"> </span>log_sqft_living <span class="op">+</span><span class="st"> </span>bathrooms_group <span class="op">+</span><span class="st"> </span>grade_categ <span class="op">+</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>waterfront <span class="op">+</span><span class="st"> </span>view, <span class="dt">data =</span> datos_train_model)</a>
<a class="sourceLine" id="cb101-4" title="4"><span class="kw">summary</span>(modelo3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_price ~ log_sqft_living + bathrooms_group + 
##     grade_categ + lat + waterfront + view, data = datos_train_model)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.266085 -0.040327 -0.001998  0.038176  0.259717 
## 
## Coefficients:
##                  Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)     -0.021703   0.012338  -1.759               0.0786 .  
## log_sqft_living  0.512808   0.007366  69.622 &lt; 0.0000000000000002 ***
## bathrooms_group  0.063002   0.006660   9.460 &lt; 0.0000000000000002 ***
## grade_categ1    -0.004398   0.012351  -0.356               0.7218    
## grade_categ2     0.066022   0.012637   5.225          0.000000177 ***
## lat              0.213553   0.002293  93.134 &lt; 0.0000000000000002 ***
## waterfront1      0.083968   0.007238  11.600 &lt; 0.0000000000000002 ***
## view1            0.047200   0.004198  11.243 &lt; 0.0000000000000002 ***
## view2            0.044979   0.002489  18.074 &lt; 0.0000000000000002 ***
## view3            0.063506   0.003424  18.548 &lt; 0.0000000000000002 ***
## view4            0.082227   0.005176  15.887 &lt; 0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0624 on 15118 degrees of freedom
## Multiple R-squared:  0.701,  Adjusted R-squared:  0.7008 
## F-statistic:  3544 on 10 and 15118 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="co"># R_squared = 0.70</span></a>
<a class="sourceLine" id="cb103-2" title="2"></a>
<a class="sourceLine" id="cb103-3" title="3">modelo3&lt;-<span class="kw">lm</span>(<span class="dt">formula =</span> log_price <span class="op">~</span><span class="st"> </span>log_sqft_living <span class="op">+</span><span class="st"> </span>bathrooms_group <span class="op">+</span><span class="st"> </span>grade_categ <span class="op">+</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>floors <span class="op">+</span><span class="st"> </span>view, <span class="dt">data =</span> datos_train_model)</a>
<a class="sourceLine" id="cb103-4" title="4"><span class="kw">summary</span>(modelo3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_price ~ log_sqft_living + bathrooms_group + 
##     grade_categ + lat + floors + view, data = datos_train_model)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.264912 -0.040219 -0.002497  0.037987  0.255935 
## 
## Coefficients:
##                  Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)     -0.017812   0.012356  -1.442                0.149    
## log_sqft_living  0.514837   0.007382  69.740 &lt; 0.0000000000000002 ***
## bathrooms_group  0.033817   0.007305   4.629          0.000003705 ***
## grade_categ1    -0.004757   0.012365  -0.385                0.700    
## grade_categ2     0.064685   0.012652   5.113          0.000000322 ***
## lat              0.211627   0.002298  92.097 &lt; 0.0000000000000002 ***
## floors           0.027999   0.002783  10.062 &lt; 0.0000000000000002 ***
## view1            0.049738   0.004208  11.821 &lt; 0.0000000000000002 ***
## view2            0.046588   0.002493  18.687 &lt; 0.0000000000000002 ***
## view3            0.068574   0.003416  20.074 &lt; 0.0000000000000002 ***
## view4            0.118213   0.004251  27.810 &lt; 0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06246 on 15118 degrees of freedom
## Multiple R-squared:  0.7003, Adjusted R-squared:  0.7001 
## F-statistic:  3533 on 10 and 15118 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># R_squared = 0.7</span></a>
<a class="sourceLine" id="cb105-2" title="2"></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="kw">vif</span>(modelo3) <span class="co">#nos da un factor que mida la inflacion de la varianza por tener variable co-lineales</span></a></code></pre></div>
<pre><code>##                     GVIF Df GVIF^(1/(2*Df))
## log_sqft_living 2.593077  1        1.610303
## bathrooms_group 2.775579  1        1.666007
## grade_categ     1.317442  2        1.071354
## lat             1.009433  1        1.004705
## floors          1.408083  1        1.186627
## view            1.097868  4        1.011740</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="co"># usamos una seleccion automatica de variables para comparar la evaluacion del modelo</span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="co"># regfit_full &lt;- leaps::regsubsets(log_price~., datos_train_model[c(2:5,7,10:13,16:21)]) #Best subset</span></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="co"># reg_sum</span></a>
<a class="sourceLine" id="cb107-4" title="4"><span class="co"># reg_sum &lt;- summary(regfit_full)</span></a>
<a class="sourceLine" id="cb107-5" title="5"><span class="co"># coef(regfit_full, 6)</span></a>
<a class="sourceLine" id="cb107-6" title="6"></a>
<a class="sourceLine" id="cb107-7" title="7"></a>
<a class="sourceLine" id="cb107-8" title="8"></a>
<a class="sourceLine" id="cb107-9" title="9"><span class="co"># modelo con las caracteristicas de la seleccion automatica Best subset</span></a>
<a class="sourceLine" id="cb107-10" title="10"><span class="co"># modelo3&lt;-lm(formula = log_price ~ floors + waterfront+ yr_built + lat + log_sqft_living + grade_categ, data = datos_train_model)</span></a>
<a class="sourceLine" id="cb107-11" title="11"><span class="co"># summary(modelo3)</span></a>
<a class="sourceLine" id="cb107-12" title="12"><span class="co"># R_squared = 0.7</span></a>
<a class="sourceLine" id="cb107-13" title="13"></a>
<a class="sourceLine" id="cb107-14" title="14"></a>
<a class="sourceLine" id="cb107-15" title="15"></a>
<a class="sourceLine" id="cb107-16" title="16"><span class="co"># modelo regularización lasso</span></a>
<a class="sourceLine" id="cb107-17" title="17"><span class="co"># x &lt;- model.matrix(log_price~., datos_train_model[c(2:5,7,10:13,16:21)])</span></a>
<a class="sourceLine" id="cb107-18" title="18"><span class="co"># x</span></a>
<a class="sourceLine" id="cb107-19" title="19"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-20" title="20"><span class="co"># y &lt;- datos_train_model$log_price</span></a>
<a class="sourceLine" id="cb107-21" title="21"><span class="co"># y</span></a>
<a class="sourceLine" id="cb107-22" title="22"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-23" title="23"><span class="co"># library(glmnet)</span></a>
<a class="sourceLine" id="cb107-24" title="24"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-25" title="25"><span class="co"># set.seed(1234)</span></a>
<a class="sourceLine" id="cb107-26" title="26"><span class="co"># cv_result &lt;- cv.glmnet(x,y,alpha=1)</span></a>
<a class="sourceLine" id="cb107-27" title="27"><span class="co"># cv_result</span></a>
<a class="sourceLine" id="cb107-28" title="28"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-29" title="29"><span class="co"># plot(cv_result)</span></a>
<a class="sourceLine" id="cb107-30" title="30"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-31" title="31"><span class="co"># best_lam &lt;- cv_result$lambda.min</span></a>
<a class="sourceLine" id="cb107-32" title="32"><span class="co"># best_lam</span></a>
<a class="sourceLine" id="cb107-33" title="33"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-34" title="34"><span class="co"># out &lt;- glmnet(x,y,alpha=1,lambda = best_lam)</span></a>
<a class="sourceLine" id="cb107-35" title="35"><span class="co"># out</span></a>
<a class="sourceLine" id="cb107-36" title="36"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-37" title="37"><span class="co"># lasso_coef &lt;- predict(out,type=&quot;coefficients&quot;,s=best_lam)[1:20,]</span></a>
<a class="sourceLine" id="cb107-38" title="38"><span class="co"># lasso_coef[lasso_coef!=0]</span></a>
<a class="sourceLine" id="cb107-39" title="39"><span class="co"># lasso_coef</span></a>
<a class="sourceLine" id="cb107-40" title="40"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-41" title="41"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-42" title="42"><span class="co"># first_six &lt;- max(which(cv_result$nzero == 6))</span></a>
<a class="sourceLine" id="cb107-43" title="43"><span class="co"># first_six</span></a>
<a class="sourceLine" id="cb107-44" title="44"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-45" title="45"><span class="co"># my_lam &lt;- cv_result$lambda[first_six]</span></a>
<a class="sourceLine" id="cb107-46" title="46"><span class="co"># my_lam</span></a>
<a class="sourceLine" id="cb107-47" title="47"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-48" title="48"><span class="co"># out_six &lt;- glmnet(x,y,alpha=1,lambda = first_six)</span></a>
<a class="sourceLine" id="cb107-49" title="49"><span class="co"># out_six</span></a>
<a class="sourceLine" id="cb107-50" title="50"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-51" title="51"><span class="co"># lasso_coef_six &lt;- predict(out_six,type=&quot;coefficients&quot;)[1:20,]</span></a>
<a class="sourceLine" id="cb107-52" title="52"><span class="co"># lasso_coef_six</span></a>
<a class="sourceLine" id="cb107-53" title="53"><span class="co"># </span></a>
<a class="sourceLine" id="cb107-54" title="54"><span class="co"># lasso_coef_six[lasso_coef_six!=0]</span></a>
<a class="sourceLine" id="cb107-55" title="55"><span class="co"># lasso_coef_six</span></a></code></pre></div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="selección-de-variable.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
